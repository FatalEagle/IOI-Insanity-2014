<h3>Maniacal Midsummer Marathon 2014 by TL, AL, JJ</h3>
<h2>Problem G: Campfire Cooking</h2>

<p>Esdeath is currently enjoying a wonderful dinner with subordinates in her army. There is a giant pot on a campfire, and <var>N</var> (2 &le; <var>N</var> &le; 100000) soldiers surrounding the pot in a circle, numbered clockwise from 1 to <var>N</var>. Each soldier holds a very large supply of a specific type of food that tastes best when cooked at a specific range of temperatures. Soldier <var>i</var>'s food tastes best when it is cooked between <var>A<sub>i</sub></var> and <var>B<sub>i</sub></var> degrees Celsius, inclusive. We shall refer to this as the <i>optimal temperature range</i>.</p>

<p>The entire campfire cooking session will last <var>M</var> (1 &le; <var>M</var> &le; 100000) minutes. During each of these minutes, one of three possible events will occur:</p>

<ol>
<li>
<p>Esdeath would like to try a combination of foods, so all soldiers with a number between <var>i</var> and <var>j</var> (1 &le; <var>i</var>, <var>j</var> &le; <var>N</var>; note: it is <i>not</i> necessarily true that <var>i</var> &le; <var>j</var>) will pitch in some food if the type of food they hold tastes best within a certain range of the pot's current temperature <var>T</var> degrees Celsius. That is, if a soldier is <i>between</i> soldiers <var>i</var> and <var>j</var> inclusive, they must contribute if their optimal temperature range overlaps with the range [<var>T</var> &minus; <var>L</var>, <var>T</var> + <var>H</var>] (0 &le; <var>L</var>, <var>H</var> &le; 100000). Here, <i>between</i> means starting from the <var>i</var>-th soldier and going clockwise around the circle, considering every soldier you pass up to and including the <var>j</var>-th soldier.</p>

<p>After each time Esdeath performs this event, the temperature of the pot will change based on three constant values <var>X</var>, <var>Y</var>, and <var>Z</var> (0 &le; <var>X</var>, <var>Y</var> &le; 1000; 1 &le; <var>Z</var> &le; 100000). The new temperature after each instance of this event is determined by the formula: <var>T</var><sub>new</sub> = ((<var>T</var><sub>old</sub>*<var>X</var> + <var>F</var>*<var>Y</var>) mod <var>Z</var>) + 1, where <var>F</var> is the number of foods tossed into the pot. We'll assume that each soldier has a very large quantity of their own type of food, and will always be able to contribute if his or her temperature range is right. Every time this event is called, please determine <var>F</var>, the number of foods that have been tossed into the pot.</p>
</li>

<li><p>The <var>i</var>-th soldier gets a new type food, getting rid of their old type of food. The new type food will have an optimal temperature range between <var>L</var> and <var>H</var> (1 &le; <var>i</var> &le; <var>N</var>; 1 &le; <var>L</var> &le; <var>H</var> &le; <var>Z</var>).</p></li>

<li>For this event, Esdeath would like to know, hypothetically, if all soldiers between <var>i</var> and <var>j</var> were to put some of their food into the pot in increasing order of the <var>A<sub>i</sub></var> temperatures of their food (the lower bounds of their foods' optimal temperature ranges), what would be the <var>A<sub>i</sub></var> temperature of the <var>k</var>-th soldier who places food into the pot?</li>
</ol>

<h3>Input Format</h3>
<p>
Line 1: Six integers <var>N</var>, <var>M</var>, <var>T</var>, <var>X</var>, <var>Y</var>, and <var>Z</var>.
<br/>
Next <var>N</var> lines: line <var>i</var>+1 will contain two integers <var>A</var><sub>i</sub> and <var>B</var><sub>i</sub>, the optimal temperature range for soldier <var>i</var>'s initial type of food.
<br/>
Next <var>M</var> lines: line <var>i</var>+<var>N</var>+1 will describe the event that happens in the <var>i</var>-th minute of the cooking session. Each line will be in one of the following three formats to represent the three types of events:

<ul>
<li>Type 1 events will be in the format:<code> 1 <var>i</var> <var>j</var> <var>L</var> <var>H</var></code></li>
<li>Type 2 events will be in the format:<code> 2 <var>i</var> <var>L</var> <var>H</var></code></li>
<li>Type 3 events will be in the format:<code> 3 <var>i</var> <var>j</var> <var>k</var></code></li>
</ul>
</p>

<p>At any given time the pot's temperature <var>T</var> will satisfy 1 &le; <var>T</var> &le; <var>Z</var>. Furthermore, the total number of type 2 events will not exceed 25000.</p>

<h3>Subtask 1 [8% of points]</h3>

<p><var>N</var>, <var>T</var> &le; 1000 <br />
Additionally, there will be no events of type 3.</p>

<h3>Subtask 2 [17% of points]</h3>

<p>In all events of type 1, <var>L</var> = <var>H</var> = 0 <br />
Additionally, there will be no events of type 3.</p>

<h3>Subtask 3 [20% of points]</h3>

<p><var>X</var> = 1 and <var>Y</var> = 0 <br />
Additionally, there will be no events of type 3.</p>

<h3>Subtask 4 [15% of points]</h3>

<p>There will only be events of type 1.</p>

<h3>Subtask 5 [17% of points]</h3>

<p>There will be no events of type 3.</p>

<h3>Subtask 6 [20% of points]</h3>

<p>There are no additional restrictions.</p>

<h3>Subtask 7 [3% of points]</h3>

<p><em>For this subtask alone</em>, there will be a case where <var>N</var> = 200000 and <var>M</var> = 200000.</p>

<style type="text/css">
#samples td {
  vertical-align: text-top;
  padding-right: 50px;
}
</style>

<table id="samples">
<tr><td>
<h3>Sample Input 1</h3>
<pre>
5 4 4 1 1 10
1 3
4 6
7 9
3 5
2 4
1 1 5 1 0
1 2 4 0 0
1 3 3 0 0
1 3 2 0 0
</pre>
</td>
<td>
<h3>Sample Input 2</h3>
<pre>
3 10 1 2 3 10
1 1
1 5
1 10
1 1 3 0 9
2 3 10 10
1 1 3 1 1
1 1 3 0 9
1 1 3 0 1
2 2 9 9
1 1 3 0 2
1 1 3 2 0
1 1 2 0 0
1 1 2 0 0
</pre></td><td>
<h3>Sample Input 3</h3>
<pre>
5 12 1 0 0 5
3 3
1 1
3 3
4 4
2 2
3 1 5 1
3 2 1 2
3 3 2 3
3 4 3 4
3 5 4 5
3 1 3 1
3 1 3 2
3 1 3 3
3 4 2 4
3 1 2 3
3 4 1 5
3 4 1 2
</pre><br/></td></tr>
<tr><td>
<h3>Sample Output 1</h3>
<pre>
4
1
0
2
</pre></td><td>
<h3>Sample Output 2</h3>
<pre>
3
2
3
1
2
1
0
1
</pre></td><td>
<h3>Sample Output 3</h3>
<pre>
1
2
3
3
4
1
3
3
4
-1
-1
3
</pre></td>
</tr>
</table>

<h3>Explanation for Sample 1</h3>
<p>
The pot starts at a temperature of 4 degrees Celsius. The range of temperatures is [3, 4].<br/>
All soldiers participate, and 4 types of food are thrown into the pot. The temperature becomes (4*1 + 4*1) mod 10 + 1 = 9 degrees Celsius.<br/>
Soldiers 2, 3, and 4 participate, and 1 type of food is thrown into the pot. The temperature becomes (9*1 + 1*1) mod 10 + 1 = 1 degrees Celsius.<br/>
The third soldier cannot throw any food into the pot. The temperature becomes (1*1 + 0*1) mod 10 + 1 = 2 degrees Celsius.<br/>
All soldiers participate again, and 2 pieces of food are thrown into the pot. The temperature becomes (2*1 + 2*1) mod 10 + 1 = 5 degrees Celsius, and the cooking session ends.
</p>
