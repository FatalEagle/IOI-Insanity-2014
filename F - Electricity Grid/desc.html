<h3>Maniacal Midsummer Marathon 2014 by AL, TL, JJ</h3>
<h2>Problem F: Electricity Grid</h2>

<p>You have just been hired as the new manager of a city's main power plant. Going to work on your first day, you learned that the company has been losing massive amounts of money. After some investigating, you've discovered that this is because the company has been delivering unnecessarily high amounts of energy to the substations in the city's electricity grid!</p>

<p>The electricity grid consists of <var>N</var> (1 &le; <var>N</var> &le; 100) substations and <var>M</var> (0 &le; <var>M</var> &le; 400) wires connecting the substations. These substations are interspersed throughout the city and are responsible for distributing power to consumers. Electricity can only travel in one direction along each wire, and the direction on a wire can never be reversed. The substations are each labeled with a unique integer from 1 to <var>N</var>. Substation <var>i</var> has a monthly energy usage of <var>E<sub>i</sub></var> (1 &le; <var>E<sub>i</sub></var> &le; 100000) megajoules. Through field research, your company has determined that substation <var>i</var> supplies the company with a monthly profit of <var>P<sub>i</sub></var> (&minus;10000000 &le; <var>P<sub>i</sub></var> &le; 10000000) dollars.</p>

<p>Some of these substations are just too wasteful, so it's time for a reform! You would like to pick out some subset of all of the substations in the entire city to keep for the long term. There is a catch: for any of the substations you wish to keep, you must keep all the substations that depend on it for electricity, directly or indirectly. More specifically, in order to keep a substation <var>i</var>, any substation <var>j</var> such that electricity can flow from <var>i</var> to <var>j</var> using any series of connected wires or substations, must also be kept.</p>

<p>Just when you thought your new job couldn't get any harder, the tyrants from the EPA came over and complained that the maximum energy usage across your substations is too high, and will harm the environment. Every month, they will fine you <var>A</var> dollars for every megajoule of <var>E<sub>max</sub></var>, your maximum energy usage. The value of <var>E<sub>max</sub></var> for a set of substations is the maximum <var>E<sub>i</sub></var> across all <var>i</var> in the set. Therefore, your total monthly profit after the reform is the sum of all <var>P<sub>i</sub></var> values for the stations you choose to keep, subtract <var>A</var>&times;<var>E<sub>max</sub></var> across those stations. The fine per megajoule will be a nonnegative integer less than 10000.</p>

<p>To save yourself from some headaches, you might as well write a program to determine the highest possible total monthly profit that you can obtain by keeping a subset of the power substations.</p>

<h3>Input Format</h3>
<p>
Line 1: three integers <var>N</var>, <var>M</var>, and <var>A</var>, representing the number of substations, the number of wires, and the EPA fine factor.<br/>
Next <var>N</var> lines: two integers <var>P<sub>i</sub></var> and <var>E<sub>i</sub></var>, representing the profit and monthly energy usage of station <var>i</var>.<br/>
Next <var>M</var> lines: two integers <var>a<sub>i</sub></var> and <var>b<sub>i</sub></var>, indicating that there is a one-way wire from substation <var>a<sub>i</sub></var> to <var>b<sub>i</sub></var>.
</p>

<h3>Output Format</h3>
<p>A single integer representing the highest possible total monthly profit (in dollars) obtainable by selecting a subset of all of the <var>N</var> substations.</p>

<h3>Sample Input 1</h3>
<pre>
4 3 1
5 3
-7 2
15 4
-3 1
1 2
2 3
3 4
</pre>

<h3>Sample Output 1</h3>
<pre>
8
</pre>

<h3>Explanation for Sample 1</h3>
<p>There are 4 substations with profits {$5, &minus;$7, $15, &minus;$3} and monthly energy usages of {3, 2, 4, 1}.<br/>
If we choose to keep substations 3 and 4, then the monthly subtotal profit is $(15 + (&minus;3)) = $12.<br/>
The EPA fine will be $1&times;max(4, 1) = $4, so the total monthly profit is $12 &minus; $4 = $8. In fact, $8 is the best answer for this example.</p>

<h3>Sample Input 2</h3>
<pre>
4 4 1
-1 1
2 1
-3 1
4 1
1 2
2 3
3 4
4 1
</pre>

<h3>Sample Output 2</h3>
<pre>
1
</pre>

<h3>Explanation for Sample 2</h3>
<p>It's possible that cyclic dependencies exist, as shown by these four substations. You must take either all or none, and your best choice is to take them all for a profit of $1.</p>

<h3>Sample Input 3</h3>
<pre>
3 3 8
15 2
-10 1
10 1
1 2
3 2
1 3
</pre>

<h3>Sample Output 3</h3>
<pre>
0
</pre>

<h3>Explanation for Sample 3</h3>
<p>It is not profitable to keep any substation because the fine by the EPA would always be more than the profit obtainable from keeping any valid subset of substations.<br/>
(With no functional substations anywhere, you should probably be heading to the bank to file bankruptcy for your company.)</p>
